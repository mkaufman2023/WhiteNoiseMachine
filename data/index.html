<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>White Noise Machine</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="White Noise">
    <link rel="apple-touch-icon" href="/icon.svg">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/svg+xml" href="/icon.svg">
   
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #111827;
            color: #e5e7eb;
            margin: 0;
            padding: 1.5rem;
            text-align: center;
            padding-top: env(safe-area-inset-top, 20px);
        }
        h1 {
            margin-bottom: 0.5rem;
        }
        .subtitle {
            font-size: 0.9rem;
            color: #9ca3af;
            margin-bottom: 1.5rem;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            max-width: 480px;
            margin: 0 auto;
        }
        button {
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            border: none;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            background: #1f2937;
            color: #e5e7eb;
            box-shadow: 0 8px 16px rgba(0,0,0,0.35);
            transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.15s ease;
        }
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 12px 22px rgba(0,0,0,0.5);
            background: #374151;
        }
        button:active {
            transform: translateY(1px) scale(0.98);
            box-shadow: 0 6px 10px rgba(0,0,0,0.4);
            background: #111827;
        }
        .status {
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: #9ca3af;
            min-height: 1.2em;
        }
        .warning-banner {
            background-color: #ef4444;
            color: white;
            padding: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            display: none;  /* Hidden by default */
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div id="hw-alert" class="warning-banner">
        âš  Hardware Failure: DFPlayer not detected. Check internal wiring/SD card.
    </div>
    <h1>White Noise Machine</h1>
    <div class="subtitle">Tap a sound to start playing it.</div>

    <div class="grid">
        <button onclick="play_track(1)">âœˆ Airplane Cabin</button>
        <button onclick="play_track(2)">ğŸŒŒ Celestial</button>
        <button onclick="play_track(3)">â›ˆ Thunderstorm</button>
        <button onclick="play_track(4)">ğŸŒ§ Rain</button>
        <button onclick="play_track(5)">ğŸŒ¿ Rainforest</button>
        <button onclick="play_track(6)">ğŸ Waterfall</button>
        <button onclick="play_track(7)">â›² Water Fountain</button>
        <button onclick="play_track(8)">ğŸŒŠ Ocean Waves</button>
        <button onclick="play_track(9)">ğŸŒ€ Fan</button>
        <button onclick="play_track(10)">ğŸ”¥ Campfire</button>
        <button onclick="play_track(11)">ğŸš¿ Shower</button>
        <button onclick="play_track(12)">ğŸ’¨ Hairdryer</button>
        <button onclick="play_track(13)">ğŸ§¹ Vacuum Cleaner</button>
    </div>

    <div class="status" id="status"></div>

    <script>
        async function play_track(n) {
            const status_element = document.getElementById('status');
            status_element.textContent = 'Switching to track ' + n + '...';
            try {
                const result = await fetch('/play?track=' + encodeURIComponent(n));
                if (!result.ok) {
                    status_element.textContent = 'Error: ' + result.status;
                    return;
                }
                const text = await result.text();
                status_element.textContent = text || ('Now playing track ' + n);
            } catch (e) {
                status_element.textContent = 'Request failed.';
            }
        };

        window.onload = async function() {
            try {
                const result = await fetch('/status');
                const state = await result.text();

                if (state === "0") {
                    document.getElementById('hw-alert').style.display = 'block';
                }
            } catch (e) {
                console.log("Could not fetch status");
            }
        };
    </script>
</body>
</html>